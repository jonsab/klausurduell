<!doctype html>
<html>
<head>
    <title>blblablaa</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css">
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <script>
        $(document).ready(function () {

            $("#button_registrieren").click(function () {

                benutzername = $("#input_benutzername").val()
                kennwort = $("#input_kennwort").val()

                if (benutzername == "") {

                    $("#label_statusmeldung").text("Bitte wählen Sie einen Benutzernamen.");
                    return
                }

                if (kennwort == "") {

                    $("#label_statusmeldung").text("Bitte wählen Sie ein Kennwort.");
                    return
                }
                
                $.ajax("http://buchholz.hs-bremen.de/klausurduell/registrieren.aspx", {

                    jsonp: "callback",

                    dataType: "jsonp",

                    data: {
                        input_benutzername: benutzername,
                        input_kennwort: kennwort
                    },

                    success: function (response) {
//                        $("#label2").text(JSON.stringify(response));  
                        if (response.status == "ok") {

                            $("#label_statusmeldung").text("Registrierung war erfolgreich.");

                        } else {

                            $("#label_statusmeldung").text("Bitte wählen Sie einen anderen Benutzernamen.");

                        }

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        $("#label2").text(textStatus);
                    }
                });
            });

            $("#button_login").click(function () {

                benutzername = $("#input_benutzername").val()
                kennwort = $("#input_kennwort").val()

                if (benutzername == "") {

                    $("#label_statusmeldung").text("Bitte geben Sie Ihren Benutzernamen ein.");
                    return
                }

                if (kennwort == "") {

                    $("#label_statusmeldung").text("Bitte geben Sie Ihr Kennwort ein.");
                    return
                }

                $.ajax("http://buchholz.hs-bremen.de/klausurduell/login.aspx", {
                    jsonp: "callback",

                    dataType: "jsonp",

                    data: {
                        input_benutzername: benutzername,
                        input_kennwort: kennwort
                    },

                    success: function (response) {
                        if (response.status == "ok") {

                            localStorage.benutzername = benutzername
                            $("#label_statusmeldung").text(localStorage.benutzername)
                            window.location.href = "spiel.html"

                        } else {

                            $("#label_statusmeldung").text("Login war nicht erfolgreich.");

                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        $("#label2").text(textStatus);
                    }
                });
            });
        });
    </script>
    <style type="text/css">
        .auto-style1 {
            width: 100%;
        }

        .auto-style2 {
            height: 26px;
        }

        .auto-style3 {
            height: 26px;
            width: 154px;
        }

        .auto-style4 {
            width: 154px;
        }
        .auto-style5 {
            color: #FF6600;
        }
    </style>
</head>
<body>
    <div data-role="page" id="page1">

        <div data-role="header">
            <h1>Login</h1>
        </div>
        <!-- /header -->

        <div data-role="content">
            <table class="auto-style1">
                <tr>
                    <td class="auto-style3">Benutzername: </td>
                    <td class="auto-style2">
                        <input type="text" id="input_benutzername" style="width: 100%"></td>
                </tr>
                <tr>
                    <td class="auto-style4">Kennwort: </td>
                    <td>
                        <input type="password" id="input_kennwort" style="width: 100%"></td>
                </tr>
            </table>
            <button id="button_login" data-inline="true">Login</button>
            <button id="button_registrieren" data-inline="true">Registrieren</button>
            <a href="page2.html">test</a>
            <label id="label2">label2</label>
            <br />
            <span class="auto-style5">
            <label id="label_statusmeldung"></label></span>
        </div>
        

    </div>
    <!-- /page -->

</body>
</html>
